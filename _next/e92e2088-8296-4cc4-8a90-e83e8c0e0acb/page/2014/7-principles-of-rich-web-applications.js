module.exports=__NEXT_REGISTER_PAGE("/2014/7-principles-of-rich-web-applications",function(){return{page:webpackJsonp([1],{102:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(1),s=a.n(n),i=a(0),o=a.n(i);t.b=function(e){var t=e.children;return o.a.createElement("ul",{className:"jsx-4231533587"},t,o.a.createElement(s.a,{styleId:"4231533587",css:["ul.jsx-4231533587{margin:0 0 20px 0;padding:0;list-style-type:none;}"]}))};var r=function(e){var t=e.children;return o.a.createElement("li",{className:"jsx-2571652889"},t,o.a.createElement(s.a,{styleId:"2571652889",css:["li.jsx-2571652889{margin-bottom:5px;padding-left:20px;line-height:24px;}","li.jsx-2571652889:before{content:'-';color:#ABABAB;position:absolute;margin-left:-20px;}"]}))}},16:function(e,t,a){"use strict";var n=a(1),s=a.n(n),i=a(0),o=a.n(i);t.a=function(e){var t=e.children;return o.a.createElement("code",{className:"jsx-4056748551"},t,o.a.createElement(s.a,{styleId:"4056748551",css:["code.jsx-4056748551{color:#666;font-family:monospace;}"]}))}},246:function(e,t,a){e.exports=a(247)},247:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1),s=a.n(n),i=a(0),o=a.n(i),r=a(15),l=a.n(r),c=a(36),h=a(13),m=a(37),d=a(38),u=a(28),p=a(52),g=a(16),f=a(29),b=a(102),y=function(e){var t=e.children;return o.a.createElement("ul",{className:"jsx-699047170"},t,o.a.createElement(s.a,{styleId:"699047170",css:["ul.jsx-699047170{margin:0 0 20px 0;padding:0;list-style:inside decimal;}"]}))},w=function(e){var t=e.children;return o.a.createElement("li",{className:"jsx-3484367012"},t,o.a.createElement(s.a,{styleId:"3484367012",css:["li.jsx-3484367012{margin-bottom:5px;line-height:24px;}"]}))},E=function(e){var t=e.children;return o.a.createElement("div",{className:"jsx-4153657131 wrap"},o.a.createElement("b",{className:"jsx-4153657131"},"tl;DR:")," ",o.a.createElement("div",{className:"jsx-4153657131 content"},t),o.a.createElement(s.a,{styleId:"4153657131",css:[".wrap.jsx-4153657131{margin-bottom:25px;padding:15px;background:#eee;line-height:20px;}",".content.jsx-4153657131{display:inline;font-style:oblique;}"]}))},v=a(53),x=a(39),k=(t.default=Object(x.a)(function(e){var t=e.views;return o.a.createElement(c.a,null,o.a.createElement(l.a,null,o.a.createElement("title",{className:"jsx-4160647468"},"7 Principles of Rich Web Applications")),o.a.createElement(m.a,null,"7 Principles of Rich Web Applications"),o.a.createElement(d.a,{date:"November 4, 2014",views:t}),o.a.createElement(h.a,null,o.a.createElement("span",{className:"jsx-4160647468 translations"},"Also available in: ",o.a.createElement("a",{href:k[0],target:"_blank",className:"jsx-4160647468"},"Japanese"),","," ",o.a.createElement("a",{href:k[1],target:"_blank",className:"jsx-4160647468"},"Russian"),","," ",o.a.createElement("a",{href:k[2],target:"_blank",className:"jsx-4160647468"},"Portuguese")),"."),o.a.createElement(h.a,null,"This is a writeup based on a presentation I gave at BrazilJS in August 2014. It builds on some of the ideas I’ve been ",o.a.createElement("a",{href:k[3],target:"_blank",className:"jsx-4160647468"},"blogging")," "," ",o.a.createElement("a",{href:k[4],target:"_blank",className:"jsx-4160647468"},"about")," recently related mostly to UX and performance."),o.a.createElement(h.a,null,"I want to introduce 7 actionable principles for websites that want to make use of JavaScript to control their UI. They are the result of my experience as a web developer, but also as a long-time user of the WWW."),o.a.createElement(h.a,null,"JavaScript has undeniably become an indispensable tool for frontend developers. Its usage is now expanding into other areas like ",o.a.createElement("a",{href:k[5],target:"_blank",className:"jsx-4160647468"},"servers")," and ",o.a.createElement("a",{href:k[6],target:"_blank",className:"jsx-4160647468"},"microcontrollers"),". It’s the language of choice for ",o.a.createElement("a",{href:k[7],target:"_blank",className:"jsx-4160647468"},"introducing"),"  computer science concepts by prestigious universities."),o.a.createElement(h.a,null,"Yet a lot of questions on its precise role and usage on the web remain a mystery, even to many framework and library authors."),o.a.createElement(b.b,null,o.a.createElement(b.a,null,"Should JavaScript be used to replace browser functions like history, navigation and page rendering?"),o.a.createElement(b.a,null,"Is the backend dying? Should I render HTML at all?"),o.a.createElement(b.a,null,"Are Single Page Applications (SPAs) the future?"),o.a.createElement(b.a,null,"Is JS supposed to augment pages for websites, but render pages in web apps?"),o.a.createElement(b.a,null,"Should techniques like PJAX or TurboLinks be used?"),o.a.createElement(b.a,null,"What’s the precise distinction between a website and a web application? Should there be one at all?")),o.a.createElement(h.a,null,"What follows is my attempt to answer these. My approach is to examine the usage of JavaScript ",o.a.createElement("em",{className:"jsx-4160647468"},"exclusively")," from the lens of user experience (UX). In particular, I put a strong focus on the idea of minimizing the time it takes the user to get the data they are interested in. Starting with networking fundamentals all the way to predicting the future."),o.a.createElement(y,null,o.a.createElement(w,null,o.a.createElement("a",{href:"#server-rendered-pages-are-not-optional",className:"jsx-4160647468"},"Server rendered pages are not optional")),o.a.createElement(w,null,o.a.createElement("a",{href:"#act-immediately-on-user-input",className:"jsx-4160647468"},"Act immediately on user input")),o.a.createElement(w,null,o.a.createElement("a",{href:"#react-to-data-changes",className:"jsx-4160647468"},"React to data changes")),o.a.createElement(w,null,o.a.createElement("a",{href:"#control-the-data-exchange-with-the-server",className:"jsx-4160647468"},"Control the data exchange with the server")),o.a.createElement(w,null,o.a.createElement("a",{href:"#dont-break-history-enhance-it",className:"jsx-4160647468"},"Don’t break history, enhance it")),o.a.createElement(w,null,o.a.createElement("a",{href:"#push-code-updates",className:"jsx-4160647468"},"Push code updates")),o.a.createElement(w,null,o.a.createElement("a",{href:"#predict-behavior",className:"jsx-4160647468"},"Predict behavior"))),o.a.createElement(p.a,{id:"server-rendered-pages-are-not-optional"},"1. Server rendered pages are not optional"),o.a.createElement(E,null,"Server rendering is not about SEO, it’s about performance. Consider the additional roundtrips to get scripts, styles, and subsequent API requests. In the future, consider HTTP 2.0 “pushing” of resources."),o.a.createElement(h.a,null,"The first thing I’m compelled to point out is a fairly common false dichotomy. That of “server-rendered apps vs single-page apps”. If we want to optimize for the best possible user experience and performance, giving up one or the other is never a good idea."),o.a.createElement(h.a,null,"The reasons are fairly straightforward. The medium by which pages are transmitted, the internet, has a theoretical speed limit. This has been memorably illustrated by the famous essay/rant ",o.a.createElement("a",{href:k[8],target:"_blank",className:"jsx-4160647468"},"“It’s the latency, stupid”")," by Stuart Cheshire:"),o.a.createElement(f.a,null,"The distance from Stanford to Boston is 4320km.\nThe speed of light in vacuum is 300 x 10^6 m/s.\nThe speed of light in fibre is roughly 66% of the speed of light in vacuum.\nThe speed of light in fibre is 300 x 10^6 m/s * 0.66 = 200 x 10^6 m/s.\nThe one-way delay to Boston is 4320 km / 200 x 10^6 m/s = 21.6ms.\nThe round-trip time to Boston and back is 43.2ms.\nThe current ping time from Stanford to Boston over today’s Internet is about 85ms (…)\nSo: the hardware of the Internet can currently achieve within a factor of two of the speed of light."),o.a.createElement(h.a,null,"The cited 85ms round-trip time between Boston and Stanford will certainly improve over time, and your own experiments right now might already show it. But it’s important to note that there’s a theoretical minimum of about ",o.a.createElement("strong",{className:"jsx-4160647468"},"50ms")," between the two coasts."),o.a.createElement(h.a,null,"The bandwidth capacity of your users’ connections might improve noticeably, as it steadily has, but the latency needle won’t move much at all. This means that minimizing the number of roundtrips you make to display information on page is essential to great user experience and responsiveness."),o.a.createElement(h.a,null,"This becomes particularly relevant to point out considering the rise of JavaScript-driven applications that usually consist of no markup other than ",o.a.createElement(g.a,null,"<script>")," and ",o.a.createElement(g.a,null,"<link>")," tags beside an empty ",o.a.createElement(g.a,null,"<body>"),". This class of application has received the name of “Single Page Applications” or “SPA”. As the name implies, there’s only one page the server consistently returns, and all the rest is figured out by your client side code."),o.a.createElement(h.a,null,"Consider the scenario where the user navigates to ",o.a.createElement(g.a,null,"http://app.com/orders/")," after following a link or typing in the URL. At the time your application receives and processes the request, it already has important ",o.a.createElement("em",{className:"jsx-4160647468"},"information")," about what’s going to be shown on that page. It could, for example, pre-fetch the orders from the database and include them in the response. In the case of most SPAs, a blank page and a ",o.a.createElement("code",{className:"jsx-4160647468"},"<script>")," tag is returned instead, and another roundtrip will be made to get the scripts contents. So that then another roundtrip can be made to get the data needed for rendering."),o.a.createElement(v.c,{desc:"Analysis of the HTML sent by the server for every page of a SPA in the wild"},o.a.createElement(v.a,{src:"https://cldup.com/kpfLbf6dha.png"})),o.a.createElement(h.a,null,"At this point many developers consciously accept this tradeoff because they make sure the extra network hops happen only once for their users by sending the proper cache headers in the script and stylesheet responses. The general consensus is that it’s an acceptable tradeoff because once the bundle is loaded, you can then handle most of the user interaction (like transitions to other pages) without requesting additional pages or scripts."),o.a.createElement(h.a,null,"However, even in the presence of a cache, there’s a performance penalty when considering script parsing and evaluation time. ",o.a.createElement("a",{href:k[9],target:"_blank",className:"jsx-4160647468"},"“Is jQuery Too Big For Mobile?”")," describes how even for jQuery alone this could be in the order of hundreds of milliseconds for certain mobile browsers."),o.a.createElement(h.a,null,"What’s worse, usually no feedback whatsoever is given to the user while the scripts are loading. This results in a blank page displaying and then a sudden transition to a fully loaded page."),o.a.createElement(h.a,null,"Most importantly, we usually forget that the current prevailing transport of internet data (TCP) ",o.a.createElement("em",{className:"jsx-4160647468"},"starts slowly"),". This pretty much guarantees that most script bundles won’t be fetched in one roundtrip, making the situation described above even worse."),o.a.createElement(h.a,null,"A TCP connection starts with an initial roundtrip for the handshake. If you’re using SSL, which happens to be important for safe script delivery, an additional two roundtrips are used (only one if the client is resuming a session). Only then can the server start sending data, but as it turns out, it does so slowly and incrementally."),o.a.createElement(h.a,null,"A congestion control mechanism called ",o.a.createElement("em",{className:"jsx-4160647468"},"slow start")," is built into the TCP protocol to send the data in a growing number of ",o.a.createElement("em",{className:"jsx-4160647468"},"segments"),". This has two serious implications for SPAs:"),o.a.createElement(h.a,null,"1. Large scripts take a lot longer to download than it seems. As explained in the book ",o.a.createElement("a",{href:k[10],target:"_blank",className:"jsx-4160647468"},"“High Performance Browser Networking”")," by Ilya Grigorik, it takes “four roundtrips (…) and hundreds of milliseconds of latency, to reach 64 KB of throughput between the client and server”. In this example, considering a great internet connection between London and New York, it takes 225ms before TCP is able to reach the maximum packet size."),o.a.createElement(h.a,null,"2. Since this rule applies also for the initial page download, it makes the initial content that comes rendered with the page all that much more important. As Paul Irish concludes in his presentation ",o.a.createElement("a",{href:k[11],target:"_blank",className:"jsx-4160647468"},"“Delivering the Goods”"),", the first 14kb are crucially important. This is a helpful illustration of the amount of data the server can send in each round-trip over time:"),o.a.createElement(v.c,{desc:"How many KB a server can send for each phase of the connection by segments"},o.a.createElement(v.a,{src:"https://cldup.com/WI9kN_9iyR.png"})),o.a.createElement(h.a,null,"Websites that deliver content (even if it’s only the basic layout without the data) within this window will seem extremely responsive. In fact, to many authors of fast server-side applications JavaScript is deemed unneeded or as something to be used sparingly. This bias is further strengthened if the app has a fast backend and data sources and its servers located near users (CDN)."),o.a.createElement(h.a,null,"The role of the server in assisting and speeding up content presentation is certainly application-specific. The solution is not always as straightforward as “render the entire page on the server”."),o.a.createElement(h.a,null,"In some cases, parts of the page that are not essential to what the user is likely after are better left out of the initial response and fetched later by the client. Some applications, for example, opt to render the “shell” of the page to respond immediately. Then they fetch different portions of the page in parallel. This allows for great responsiveness even in a situation with slow legacy backend services. For some pages, pre-rendering the content that’s “above ",o.a.createElement("a",{href:k[12],target:"_blank",className:"jsx-4160647468"},"the fold"),"” is also a viable option."),o.a.createElement(h.a,null,"Making a ",o.a.createElement("em",{className:"jsx-4160647468"},"qualitative assessment")," of scripts and styles based on the information the server has about the the session, the user and the URL is absolutely crucial. The scripts that deal with sorting orders will obviously be more important to ",o.a.createElement(g.a,null,"/orders")," than the logic to deal with the settings page. Maybe less intuitively, one could also make a distinction between “structural CSS” and the “skin/theme CSS”. The former might be required by the JavaScript code, so it should block, but the latter could be loaded asynchronously."),o.a.createElement(h.a,null,"A neat example of a SPA that does not incur in extra roundtrip penalties is a proof-of-concept clone of ",o.a.createElement("a",{href:k[13],target:"_blank",className:"jsx-4160647468"},"StackOverflow in 4096 bytes")," (which can theoretically be delivered on the first post-handshake roundtrip of a TCP connection!). It manages to pull this off at the expense of cacheability, by inlining all the assets within the response. With ",o.a.createElement("a",{href:k[14],target:"_blank",className:"jsx-4160647468"},"SPDY or HTTP/2 server push"),", it should be theoretically possible to deliver client code that’s cacheable in a single hop. For the time being, rendering part or all of the page on the server is the most common solution to avoiding extra roundtrips."),o.a.createElement(v.c,{desc:"Proof-of-concept SPA with inlined CSS and JS that doesn’t incur in extra roundtrips"},o.a.createElement(v.a,{src:"https://cldup.com/NeV5qFDaVR.png"})),o.a.createElement(h.a,null,"A flexible enough system that can share rendering code between browser and server and provides tools for progressively loading scripts and styles will probably eliminate the colloquial distinction between ",o.a.createElement("em",{className:"jsx-4160647468"},"websites and webapps"),". Both are reigned by the same UX principles. A blog and a CRM are fundamentally not that different. They have URLs, navigation, they show data to the user. Even a spreadsheet application, which traditionally relies a lot more on client side functionality, first needs to show the user the data he’s interested in modifying. And doing so in the least number of network roundtrips is paramount."),o.a.createElement(h.a,null,"In my view, the major tradeoffs in performance seen in many widely deployed systems these days have to do with the progressive accumulation of complexity in the stack. Technologies like JavaScript and CSS were added over time. Their popularity increased over time as well. Only now can we appreciate the impact of the different ways they’ve been applied. Some of this is addressed by improving protocols (as shown by the ongoing enhancements seen in SPDY and QUIC), but the application layer is where most of the benefits will come from."),o.a.createElement(h.a,null,"It’s helpful to refer to some of the initial discussions around the design of the initial WWW and HTML to understand this. In particular, ",o.a.createElement("a",{href:k[15],target:"_blank",className:"jsx-4160647468"},"this mailing list thread")," from 1997 proposing the addition of the ",o.a.createElement(g.a,null,"<img>")," tag to HTML. Marc Andreessen re-iterates the importance of serving information fast:"),o.a.createElement(u.a,null,'"If a document has to be pieced together on the fly, it could get arbitrarily complex, and even if that were limited we’d certainly start experiencing major hits on performance for documents structured in this way. This essentially throws the',o.a.createElement("b",{style:{color:"#D0021B"},className:"jsx-4160647468"}," single-hop principle of WWW "),"out the door (well, IMG does that too but for a very specific reason and in a very limited sense) — are we sure we want to do that?”"),o.a.createElement(p.a,{id:"act-immediately-on-user-input"},"2. Act immediately on user input"),o.a.createElement(E,null,"JavaScript allows us to mask network latency altogether. Applying this as a design principle should even remove most spinners or “loading” messages from your applications. PJAX or TurboLinks miss out on opportunities to improve the perception of speed."),o.a.createElement(h.a,null,"The first principle builds heavily on the idea of minimizing latency as the user interacts with your website."),o.a.createElement(h.a,null,"That said, despite how much effort you invest into minimizing the back-and-forth between server and client, there’s a few things beyond your control. A theoretical lower bound given by the distance between your user and your server being the unescapable one."),o.a.createElement(h.a,null,"Poor or unpredictable network quality being the other significant one. If the network connection is not great, packet re-transmission will occur. What you would expect to result in a couple roundtrips could end up taking several."),o.a.createElement(h.a,null,"And in this lies JavaScript’s greatest strength towards improving UX. With client-side code driving user interaction, we are now able to ",o.a.createElement("em",{className:"jsx-4160647468"},"mask latency"),". We can create the perception of speed. We can artificially approach zero latency."),o.a.createElement(h.a,null,"Let’s consider the basic HTML web again for a second. Documents connected together through hyperlinks, or ",o.a.createElement(g.a,null,"<a>")," tags. When any of them are clicked, the browser will make a network request that’ll take unpredictably long, then get and process its response and finally transition to the new state."),o.a.createElement(h.a,null,"JavaScript allows to ",o.a.createElement("b",{className:"jsx-4160647468"},"act immediately")," and ",o.a.createElement("b",{className:"jsx-4160647468"},"optimistically")," on user input. A click on a link or button can result in an immediate reaction without hitting the network. A famous example of this is Gmail (or Google Inbox), where archiving an email will happen immediately on the UI while the server request is sent and processed asynchronously."),o.a.createElement(h.a,null,"In the case of a form, instead of waiting for some HTML as a response after its submission, we can act right after the user presses enter. Or even better, like Google Search does, we can respond to the user holding down a key:"),o.a.createElement(v.c,{desc:"Google adapts its layout as soon as you hold down a key"},o.a.createElement(v.a,{src:"https://cldup.com/CmkksKRbrl.gif"})),o.a.createElement(h.a,null,"That particular behavior is an example of what I call ",o.a.createElement("em",{className:"jsx-4160647468"},"layout adaptation"),". The basic idea is that the first state of a page “knows” about the layout of the next state, so it can transition to it before there’s any data to populate the page with. It’s “optimistic” because there’s still a risk that the data never comes and an error should be displayed instead, but that’s obviously rare."),o.a.createElement(h.a,null,"Google’s homepage is particularly relevant to this essay because its evolution illustrates the first two principles we’ve discussed very clearly."),o.a.createElement(h.a,null,"First of all, analyzing the ",o.a.createElement("a",{href:k[16],target:"_blank",className:"jsx-4160647468"},"packet dump")," of the TCP connection to ",o.a.createElement(g.a,null,"www.google.com")," reveals they make sure to send their entire homepage all at once after the request comes in. The whole exchange, including closing the connection, takes 64ms for me in San Francisco. This has likely been the case ever since ",o.a.createElement("a",{href:k[17],target:"_blank",className:"jsx-4160647468"},"the beginning"),"."),o.a.createElement(h.a,null,"In late 2004, Google ",o.a.createElement("a",{href:k[18],target:"_blank",className:"jsx-4160647468"},"pioneered")," the usage of JavaScript to provide inline as-you-type suggestions (curiously, as a 20% time project, like Gmail). This even became an inspiration for ",o.a.createElement("a",{href:k[19],target:"_blank",className:"jsx-4160647468"},"coining AJAX"),":"),o.a.createElement(u.a,null,"Take a look at Google Suggest. Watch the way the suggested terms update as you type, almost instantly […] with no waiting for pages to reload. Google Suggest and Google Maps are two examples of a new approach to web applications that we at Adaptive Path have been calling Ajax"),o.a.createElement(h.a,null,"And in 2010 they ",o.a.createElement("a",{href:k[20],target:"_blank",className:"jsx-4160647468"},"introduced")," Instant Search, which puts JS front and center by skipping the page refresh altogether and transitioning to the “search results” layout as soon as you press a key as we saw above."),o.a.createElement(h.a,null,"Another prominent example of layout adaptation is most likely in your pocket. Ever since the early days, iPhone OS would request app authors to provide a ",o.a.createElement(g.a,null,"default.png")," image that would be rendered right away, while the actual app was loading."),o.a.createElement(v.c,{desc:"iPhone OS enforced loading default.png before the application"},o.a.createElement(v.a,{src:"https://cldup.com/Gg1AwDA71S.png"})),o.a.createElement(h.a,null,"In this case, the OS was compensating not necessarily for network latency, but CPU. This was crucial considering the constraints of the original hardware. There’s however a scenario where this technique breaks. That would be when the layout doesn’t match the stored image, as in the case of login screens. A thorough analysis of its implications was provided by ",o.a.createElement("a",{href:k[21],target:"_blank",className:"jsx-4160647468"},"Marco Arment in 2010"),"."),o.a.createElement(h.a,null,"Another form of input besides clicks and form submissions that’s greatly enhanced by JavaScript rendering is ",o.a.createElement("b",{className:"jsx-4160647468"},"file input"),"."),o.a.createElement(h.a,null,"We can capture the user’s intent to upload through a variety of means: drag and drop, paste, file picker. Then, thanks to new ",o.a.createElement("a",{href:k[22],target:"_blank",className:"jsx-4160647468"},"HTML5 APIs")," we can display content as if it had been uploaded. An example of this in action is in the work we did with Cloudup uploads. Notice how the thumbnail is generated and rendered immediately:"),o.a.createElement(v.c,{desc:"The image gets rendered and fades in before the upload completes"},o.a.createElement(v.a,{src:"https://cldup.com/iCig_gr__M.gif"})),o.a.createElement(h.a,null,"In all of these cases, we’re enhancing the perception of speed. Thankfully, there’s plenty of evidence that this is a good idea. consider ",o.a.createElement("a",{href:k[23],target:"_blank",className:"jsx-4160647468"},"the example")," of how ",o.a.createElement("em",{className:"jsx-4160647468"},"increasing")," the walk to baggage claim reduced the number of complaints at the Houston Airport, without necessarily making baggage handling faster."),o.a.createElement(h.a,null,"The application of this idea should have very profound implications on the UI of our applications. I contend that spinners or “loading indicators” should become a rarity, especially as we transition to applications with ",o.a.createElement("em",{className:"jsx-4160647468"},"live data"),", discussed in the next section."),o.a.createElement(h.a,null,"There are situations where the illusion of immediacy could actually be detrimental to UX. Consider a payment form or a logout link. Acting optimistically on those, telling the user everything is done when it’s not, can result in a negative experience."),o.a.createElement(h.a,null,"But even in those cases, the display of spinners or loading indicators should be ",o.a.createElement("b",{className:"jsx-4160647468"},"deferred"),". They should only be rendered after the user no longer considers the response was immediate. According to the often-cited ",o.a.createElement("a",{href:k[24],target:"_blank",className:"jsx-4160647468"},"research by Nielsen"),":"),o.a.createElement(u.a,null,"The basic advice regarding response times has been about the same for thirty years Miller 1968; Card et al. 1991:",o.a.createElement("br",{className:"jsx-4160647468"}),o.a.createElement("b",{className:"jsx-4160647468"},"0.1 second")," is about the limit for having the user feel that the system is reacting instantaneously, meaning that no special feedback is necessary except to display the result.",o.a.createElement("br",{className:"jsx-4160647468"}),o.a.createElement("b",{className:"jsx-4160647468"},"1.0 second")," is about the limit for the user’s flow of thought to stay uninterrupted, even though the user will notice the delay.",o.a.createElement("b",{style:{color:"#D0021B"},className:"jsx-4160647468"}," Normally, no special feedback is necessary during delays of more than 0.1 but less than 1.0 second"),", but the user does lose the feeling of operating directly on the data.",o.a.createElement("br",{className:"jsx-4160647468"}),o.a.createElement("b",{className:"jsx-4160647468"},"10 seconds")," is about the limit for keeping the user’s attention focused on the dialogue. For longer delays, users will want to perform other tasks while waiting for the computer to finish"),o.a.createElement(h.a,null,"Techniques like PJAX or TurboLinks unfortunately largely miss out on the opportunities described in this section. The client side code doesn’t “know” about the future representation of the page, until an entire roundtrip to the server occurs."),o.a.createElement(p.a,{id:"react-to-data-changes"},"3. React to data changes"),o.a.createElement(E,null,"When data changes on the server, let the clients know without asking. This is a form of performance improvement that frees the user from manual refresh actions (F5, pull to refresh). New challenges: (re)connection management, state reconciliation."),o.a.createElement(h.a,null,"The third principle is that of ",o.a.createElement("em",{className:"jsx-4160647468"},"reactivity")," of the UI with respect to data changes in the source, typically one or more database servers."),o.a.createElement(h.a,null,"Serving an HTML snapshot of data that remains static until the user refreshes the page (traditional websites) or interacts with it (AJAX) is increasingly becoming obsolete."),o.a.createElement(h.a,null,"Your UI should be ",o.a.createElement("b",{className:"jsx-4160647468"},"self-updating"),"."),o.a.createElement(h.a,null,"This is crucially important in a world of an ever-increasing number of data points, in the form of watches, phones, tablets and wearable devices yet to be designed."),o.a.createElement(h.a,null,"Consider the Facebook newsfeed at the time of its inception, when data was primarily entered through personal computers. Rendering it statically was not optimal, but it made sense if people were updating their profiles maybe once a day, if that."),o.a.createElement(h.a,null,"We now live in a world where you can upload a photo, and have your peers like it or comment on it almost immediately. The need for realtime feedback is natural due to the highly concurrent usage of the application."),o.a.createElement(h.a,null,"It would be wrong, however, to assume that the benefits of reactivity are limited to multi-user applications. Which is why I like to talk about ",o.a.createElement("em",{className:"jsx-4160647468"},"concurrent data")," points as opposed to ",o.a.createElement("em",{className:"jsx-4160647468"},"users"),". Consider the common scenario of sharing a photo you have on your phone with your own laptop:"),o.a.createElement(v.c,{desc:"A single-user application can still benefit from reactivity"},o.a.createElement(v.a,{src:"https://cldup.com/15MbLjLsfm.gif"})),o.a.createElement(h.a,null,"It’s useful to think of all the data exposed to the user as reactive. ",o.a.createElement("b",{className:"jsx-4160647468"},"Session and login state synchronization")," is an example of applying this principle uniformly. If users of your application have multiple tabs open simultaneously, logging out of one will invalidate them all. This inevitably results in enhanced privacy and security, especially in situations where multiple people have access to the same device."),o.a.createElement(v.c,{desc:"Each page reacts to the session and login state"},o.a.createElement(v.a,{src:"https://cldup.com/FS74zJHpDg.gif"})),o.a.createElement(h.a,null,"Once you set up the expectation that the information on the screen updates automatically, it’s important to consider a new need: ",o.a.createElement("b",{className:"jsx-4160647468"},"state reconciliation"),"."),o.a.createElement(h.a,null,"When receiving ordered atomic data updates, it’s easy to forget that your application should be able to update appropriately even after long periods of disconnection. Consider the scenario of closing your laptop’s lid and reopening it days later. What how does your app behave then?"),o.a.createElement(v.c,{desc:"Example of what would occur if we disregard elapsed time upon reconnection"},o.a.createElement(v.a,{src:"https://cldup.com/D7obeKaOlB.png"})),o.a.createElement(h.a,null,"The ability for your application to reconcile states disjointed in time is also relevant to our first principle. If you opt to send data with the initial page load, you must consider the time the data is on the wire until your client-side scripts load. That time is essentially equivalent to a disconnection, and the initial connection by your scripts is a session resumption."),o.a.createElement(p.a,{id:"control-the-data-exchange-with-the-server"},"4. Control the data exchange with the server"),o.a.createElement(E,null,"We can now fine-tune the data exchange with the server. Make sure to handle errors, retry on behalf of the user, sync data on the background and maintain offline caches."),o.a.createElement(h.a,null,"When the WWW was conceived, data exchange between the client and server was limited to a few ways:"),o.a.createElement(y,null,o.a.createElement(w,null,"Clicking a link would ",o.a.createElement(g.a,null,"GET")," a new page and render the new page"),o.a.createElement(w,null,"Submitting a form would ",o.a.createElement(g.a,null,"POST")," or ",o.a.createElement(g.a,null,"GET")," and render a new page"),o.a.createElement(w,null,"Embedding an image or object would ",o.a.createElement(g.a,null,"GET")," it asynchronously and render it")),o.a.createElement(h.a,null,"The simplicity of this model is attractive, and we certainly have a much higher learning curve today when it comes to understanding how data is sent and received."),o.a.createElement(h.a,null,"The biggest limitations were around the second point. The inability to send data without necessarily triggering a new page load was not optimal from a performance standpoint. But most importantly, it completely broke the back button:"),o.a.createElement(v.c,{desc:"Possibly the most annoying artifact of the old web"},o.a.createElement(v.a,{src:"https://cldup.com/mc3PlaztUS.png"})),o.a.createElement(h.a,null,"The web as an ",o.a.createElement("b",{className:"jsx-4160647468"},"application platform")," was thus inconceivable without JavaScript. AJAX constituted a ",o.a.createElement("em",{className:"jsx-4160647468"},"leapfrog")," in terms of the user experience around user submission of information."),o.a.createElement(h.a,null,"We now have a variety of APIs (",o.a.createElement(g.a,null,"XMLHttpRequest"),", ",o.a.createElement(g.a,null,"WebSocket"),", ",o.a.createElement(g.a,null,"EventSource")," to name a few) that give us fine-grained control of the data flow. In addition to the ability to send data the user inputs into a form, we now have some new opportunities to enhance UX."),o.a.createElement(h.a,null,"One that’s specially relevant to our previous principle is the ability to display the ",o.a.createElement("em",{className:"jsx-4160647468"},"connection state"),". If we set up the expectation that the data updates automatically, we ought to notify the user about being ",o.a.createElement("em",{className:"jsx-4160647468"},"disconnected")," and ongoing ",o.a.createElement("em",{className:"jsx-4160647468"},"reconnection attempts"),"."),o.a.createElement(h.a,null,"When detecting a disconnection, it’s useful to store data in memory (or even better, ",o.a.createElement(g.a,null,"localStorage"),") so that it can be sent later. This is specially important in light of the introduction of ",o.a.createElement("a",{href:k[25],target:"_blank",className:"jsx-4160647468"},"ServiceWorker"),", which enables JavaScript web applications to run in the ",o.a.createElement("em",{className:"jsx-4160647468"},"background"),". If your application is not open, you can still attempt to sync user data in the background."),o.a.createElement(h.a,null,"Consider timeouts and errors when sending data and ",o.a.createElement("b",{className:"jsx-4160647468"},"retry on behalf of the user"),". If a connection is re-established, attempt to send the data again. In the case of a persistent failure, communicate it to the user."),o.a.createElement(h.a,null,"Certain errors should be handled carefully. For example, an unexpected ",o.a.createElement(g.a,null,"403")," could mean the user’s session has been invalidated. In such cases, you have the opportunity to prompt the user to resume it by showing a login screen."),o.a.createElement(h.a,null,"It’s also important to make sure the user doesn’t inadvertently interrupt the data flow. This can happen under two situations. The first and most obvious one is closing the browser or tab, which you can attempt to prevent with ",o.a.createElement(g.a,null,"beforeunload")," handlers."),o.a.createElement(v.c,{desc:"The beforeunload browser warning"},o.a.createElement(v.a,{src:"https://cldup.com/8Eu4Sk9mD8.png"})),o.a.createElement(h.a,null,"The other (and less obvious) one is capturing page transitions before they happen, like clicking links that trigger a new page load. This gives you a chance to display your own modals."),o.a.createElement(p.a,{id:"dont-break-history-enhance-it"},"5. Don’t break history, enhance it"),o.a.createElement(E,null,"Without the browser managing URLs and history for us, new challenges emerge. Make sure not to break expectations related to scrolling. Keep your own caches for fast feedback."),o.a.createElement(h.a,null,"Form submissions aside, if we were to design any modern web application with only hyperlinks, we’d end up with fully functional back/forward navigation."),o.a.createElement(h.a,null,"Consider, for example, the typical “infinite pagination scenario”. The typical way it’s implemented involves capturing the click with JavaScript, requesting some data / HTML, injecting it. Making the ",o.a.createElement(g.a,null,"history.pushState")," or ",o.a.createElement(g.a,null,"replaceState")," call is an optional step, unfortunately not taken by many."),o.a.createElement(h.a,null,"And this is why I use the word “break”. With the simpler model the web proposed initially, this situation was not in the picture. Every state transition relied on a URL change."),o.a.createElement(h.a,null,"The flip side of this is that new opportunities emerge for enhancing history now that we can control it with JavaScript."),o.a.createElement(h.a,null,"One such opportunity is what Daniel Pipius dubbed ",o.a.createElement("a",{href:k[26],target:"_blank",className:"jsx-4160647468"},"Fast Back"),":"),o.a.createElement(u.a,null,"Back should be quick; users don’t expect data to have changed much."),o.a.createElement(h.a,null,"This is akin to considering the back button an application-level button and applying principle ",o.a.createElement("em",{className:"jsx-4160647468"},"2: act immediately on user input"),". The key is that you can now decide how to cache the previous page and render it instantly. You can then apply principle 3 and then inform the user of ",o.a.createElement("em",{className:"jsx-4160647468"},"new")," data changes that happened to that page."),o.a.createElement(h.a,null,"There are still a few cases where you won’t be in control of the caching behavior. For example, if you render a page, then navigate to a third party website, and the user clicks back. Applications that render HTML on the server and then modify it on the client are at particular risk of this subtle bug:"),o.a.createElement(v.c,{desc:"Pressing back incorrectly loads the initial HTML from the pageload"},o.a.createElement(v.a,{src:"https://cldup.com/c081WZaE8H.gif"})),o.a.createElement(h.a,null,"Another way of breaking navigation is by ignoring ",o.a.createElement("em",{className:"jsx-4160647468"},"scrolling memory"),". Once again, pages that don’t rely on JS and manual history management most likely won’t have an issue with this. But dynamic ones usually do. I tested the two most popular JavaScript-driven newsfeeds of the web: Twitter and Facebook. Both exhibited ",o.a.createElement("em",{className:"jsx-4160647468"},"scrolling amnesia"),"."),o.a.createElement(v.c,{desc:"Infinite pagination is usually susceptible to scrolling amnesia"},o.a.createElement(v.a,{src:"https://cldup.com/3m0DOKp9BW.gif"})),o.a.createElement(h.a,null,"Finally, be aware of state changes that are relevant only while navigating history. Consider this example of toggling the display of comment subtrees."),o.a.createElement(v.c,{desc:"The toggling of comments should be preserved when navigating history"},o.a.createElement(v.a,{src:"https://cldup.com/bvqcnxO0De.gif"})),o.a.createElement(h.a,null,"If the page was re-rendered by following a link within the application, the expectation of the user might be that all comments appear uncollapsed. The state was ",o.a.createElement("em",{className:"jsx-4160647468"},"volatile")," and only associated with the entry in the history stack."),o.a.createElement(p.a,{id:"push-code-updates"},"6. Push code updates"),o.a.createElement(E,null,"Pushing data without pushing code is insufficient. If your data updates automatically, so should your code. Avoid API errors and improve performance. Use stateless DOM for side-effect free repainting."),o.a.createElement(h.a,null,"Making your application react to code changes is crucially important."),o.a.createElement(h.a,null,"First of all, it reduces the surface for possible errors and increases reliability. If you make a breaking change to your backend APIs, then clients’ code ",o.a.createElement("em",{className:"jsx-4160647468"},"must")," be updated. They might otherwise not be able to understand new data, or they may send data in an incompatible format."),o.a.createElement(h.a,null,"Another equally important reason has to do with the implementation of principle #3. If your UI is self-updating, there’s little reason for users to trigger a page refresh."),o.a.createElement(h.a,null,"Keep in mind that in a traditional website, a page refresh accomplishes two things: reload the data and reload the code. Setting up a mechanism to push data without one to push code is not enough, especially in a world where a single tab (session) might stay open for a very long time."),o.a.createElement(h.a,null,"If a server push channel is in place, a notification can be emitted to clients when new code is available. In the absence of that, a version number can be appended as a header to outgoing HTTP requests. The server can then compare it to its latest known version, opt to handle request or not, and advice the client."),o.a.createElement(h.a,null,"After this, some web applications opt to refresh the page on behalf of the user when deemed appropriate. For example, if the page is ",o.a.createElement("a",{href:k[27],target:"_blank",className:"jsx-4160647468"},"not visible")," and no form inputs are filled out."),o.a.createElement(h.a,null,"A better approach is to perform ",o.a.createElement("b",{className:"jsx-4160647468"},"hot code reloading"),". This means that there would be no need to perform a full page refresh. Instead, certain modules can be swapped on the fly and their code re-executed."),o.a.createElement(h.a,null,"It’s certainly hard to make hot code reloading work for many existing codebases. It’s worth discussing then a type of architecture that elegantly separates ",o.a.createElement("em",{className:"jsx-4160647468"},"behavior")," (code) from ",o.a.createElement("em",{className:"jsx-4160647468"},"data")," (state). Such a separation would allow us to make a lot of different patches very efficient."),o.a.createElement(h.a,null,"Consider for example a module in your application that sets up an event bus (e.g: ",o.a.createElement("a",{href:k[28],target:"_blank",className:"jsx-4160647468"},"socket.io"),"). When events are received, the state of a certain component is populated and it renders to the DOM. Then you modify the behavior of that component, for example, so that it produces different DOM markup for existing and new state."),o.a.createElement(h.a,null,"The ideal scenario is that we’re able to update the code on a per-module basis. It wouldn’t make sense to restart the socket connection, for example, if we can get away with just updating the modified component’s code. Our ideal architecture for hot-code pushing is thus ",o.a.createElement("em",{className:"jsx-4160647468"},"modular"),"."),o.a.createElement(h.a,null,"But the next challenge is that modules should be able to be re-evaluated without introducing undesirable side effects. This is where an architecture like the one proposed by ",o.a.createElement("a",{href:k[29],target:"_blank",className:"jsx-4160647468"},"React")," comes particularly handy. If a component code is updated, its logic can be trivially re-executed and the DOM efficiently updates. An exploration of this concept by Dan Abramov can be ",o.a.createElement("a",{href:k[30],target:"_blank",className:"jsx-4160647468"},"found here"),"."),o.a.createElement(h.a,null,"In essence, the idea that you ",o.a.createElement("em",{className:"jsx-4160647468"},"render to")," the DOM (or ",o.a.createElement("em",{className:"jsx-4160647468"},"paint")," it) is what significantly helps with hot code swapping. If state was kept in the DOM, or event listeners where set up manually by your application, updating code would become a much more complicated task."),o.a.createElement(p.a,{id:"predict-behavior"},"7. Predict behavior"),o.a.createElement(E,null,"Negative latency."),o.a.createElement(h.a,null,"A rich JavaScript application can have mechanisms in place for predicting the ",o.a.createElement("em",{className:"jsx-4160647468"},"eventual user input"),"."),o.a.createElement(h.a,null,"The most common application of this idea is to preemptively request data from the server before an action is consummated. Starting to fetch data when you hover a hyperlink so that it’s ready when it’s clicked is a straightforward example."),o.a.createElement(h.a,null,"A slightly more advanced method is to monitor mouse movement and analyze its trajectory to detect “collisions” with actionable elements like buttons. A ",o.a.createElement("a",{href:k[31],target:"_blank",className:"jsx-4160647468"},"jQuery example"),":"),o.a.createElement(v.c,{desc:"jQuery plugin that predicts the mouse trajectory"},o.a.createElement(v.a,{src:"https://cldup.com/VZ7GRJR3Rl.gif"})),o.a.createElement(p.a,{id:"conclusion"},"Conclusion"),o.a.createElement(h.a,null,"The web remains one of the most versatile mediums for the transmission of information. As we continue to add more dynamism to our pages, we must ensure that we retain some of its great historical benefits while we incorporate new ones."),o.a.createElement(h.a,null,"Pages interconnected by hyperlinks are a great building block for any type of application. Progressive loading of code, style and markup as the user navigates through them will ensure great performance without sacrificing interactivity."),o.a.createElement(h.a,null,"New unique opportunities have been enabled by JavaScript that, once universally adopted, will ensure the best possible user experience for the broadest and freest platform in existence."),o.a.createElement(s.a,{styleId:"4160647468",css:[".translations.jsx-4160647468{color:#999;font-size:12px;}"]}))}),["http://yosuke-furukawa.hatenablog.com/entry/2014/11/14/141415","http://habrahabr.ru/post/242429/","http://wmonline.ucoz.com.br/publ/melhores_praticas/usabilidade/7_principios_de_aplicacoes_rich_web_e/22-1-0-35","https://cloudup.com/blog/the-need-for-speed","https://cloudup.com/blog/introducing-mydb","http://nodejs.org/","https://tessel.io/","http://web.stanford.edu/class/cs101/","http://www.stuartcheshire.org/rants/latency.html","http://modernweb.com/2014/03/10/is-jquery-too-big-for-mobile/","http://chimera.labs.oreilly.com/books/1230000000545/ch02.html#thats_four_rou","https://docs.google.com/presentation/d/1MtDBNTH1g7CZzhwlJ1raEJagA8qM3uoV7ta6i66bO2M/present#slide=id.g3eb97ca8f_10","https://varvy.com/pagespeed/prioritize-visible-content.html","http://danlec.com/blog/stackoverflow-in-4096-bytes","http://www.chromium.org/spdy/link-headers-and-server-hint","http://1997.webhistory.org/www.lists/www-talk.1993q1/0260.html","https://gist.github.com/rauchg/3e1b2d7529009370b986","http://en.wikipedia.org/wiki/Google#mediaviewer/File:Google1998.png","http://googleblog.blogspot.com/2004/12/ive-got-suggestion.html","http://www.adaptivepath.com/ideas/ajax-new-approach-web-applications/","http://googleblog.blogspot.com/2010/09/search-now-faster-than-speed-of-type.html","http://www.marco.org/2010/11/11/my-default-png-dilemma","https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications","http://www.nytimes.com/2012/08/19/opinion/sunday/why-waiting-in-line-is-torture.html","http://www.nngroup.com/articles/response-times-3-important-limits/","http://jakearchibald.com/2014/using-serviceworker-today/","https://medium.com/joys-of-javascript/beyond-pushstate-building-single-page-applications-4353246f4480","https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API","http://socket.io/","http://facebook.github.io/react/","http://gaearon.github.io/react-hot-loader/","https://medium.com/@cihadturhan/a-ux-idea-i-know-where-you-are-aiming-3e00d152afb2"])},28:function(e,t,a){"use strict";var n=a(1),s=a.n(n),i=a(0),o=a.n(i);t.a=function(e){var t=e.by,a=e.children;return o.a.createElement("blockquote",{className:"jsx-847609887"},o.a.createElement("p",{className:"jsx-847609887"},a,o.a.createElement("br",{className:"jsx-847609887"}),t&&"– ".concat(t)),o.a.createElement(s.a,{styleId:"847609887",css:["blockquote.jsx-847609887{margin:30px 0;color:#9B9B9B;font-style:oblique;font-size:12px;}","p.jsx-847609887{line-height:24px;}"]}))}},29:function(e,t,a){"use strict";var n=a(1),s=a.n(n),i=a(0),o=a.n(i);t.a=function(e){var t=e.children;return o.a.createElement("pre",{className:"jsx-815773015"},o.a.createElement("code",{className:"jsx-815773015"},t),o.a.createElement(s.a,{styleId:"815773015",css:["pre.jsx-815773015{line-height:20px;margin-bottom:20px;font-size:12px;}","code.jsx-815773015{color:#999;}"]}))}},52:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return h});var n=a(1),s=a.n(n),i=a(0),o=a.n(i);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=function(e){var t=e.id,a=e.level,n=void 0===a?2:a,i=e.fontSize,r=void 0===i?16:i,l=e.children;return o.a.createElement("div",{className:"jsx-3001872643"},o.a.createElement("h".concat(n),{style:{fontWeight:500,fontSize:r}},o.a.createElement("span",{className:"jsx-3001872643"},o.a.createElement("a",{href:"#".concat(t),id:t,className:"jsx-3001872643"},"#")),l),o.a.createElement(s.a,{styleId:"3001872643",css:['div.jsx-3001872643{margin:25px 0;font-family:Helvetica Neue,Helvetica,Arial, "Lucida Grande",sans-serif;}',"span.jsx-3001872643{position:absolute;margin-left:-15px;width:15px;}","a.jsx-3001872643{visibility:hidden;}","div.jsx-3001872643:hover a.jsx-3001872643,span.jsx-3001872643:hover a.jsx-3001872643{visibility:visible;}"]}))},c=l,h=function(e){return l(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){r(e,t,a[t])})}return e}({},e,{level:3,fontSize:14}))}},53:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return l});var n=a(1),s=a.n(n),i=a(0),o=a.n(i);t.c=function(e){var t=e.desc,a=e.href,n=e.children,i=e.wide;return o.a.createElement("div",{className:"jsx-2740946856 "+(i?"wide":"")},a?o.a.createElement("a",{href:a,target:"_blank",className:"jsx-2740946856"},n):n,t&&o.a.createElement("p",{className:"jsx-2740946856"},t),o.a.createElement(s.a,{styleId:"2740946856",css:["div.jsx-2740946856{text-align:center;margin-bottom:20px;}","p.jsx-2740946856{font-size:13px;color:#999;text-align:center;font-style:oblique;display:block;}",".wide.jsx-2740946856{background:#F2F2F2;position:relative;}",".wide.jsx-2740946856::before{width:10000%;content:'';left:-1000px;height:100%;position:absolute;background:#F2F2F2;z-index:-1;}"]}))};var r=function(e){var t=e.width,a=e.src;return o.a.createElement("div",{className:"jsx-3393864610"},o.a.createElement("img",{width:t,src:a,className:"jsx-3393864610"}),o.a.createElement(s.a,{styleId:"3393864610",css:["img.jsx-3393864610{max-width:100%;margin:15px 0;}"]}))},l=function(e){var t=e.src;return o.a.createElement("div",{className:"jsx-1429339808"},o.a.createElement("video",{autoPlay:!0,loop:!0,src:t,className:"jsx-1429339808"}),o.a.createElement(s.a,{styleId:"1429339808",css:["video.jsx-1429339808{max-width:100%;margin:15px 0;}"]}))}}},[246]).default}});